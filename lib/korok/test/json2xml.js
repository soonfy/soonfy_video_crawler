import { expect } from 'chai'
import { Json2Xml } from "../src/parser/json2xml"
import { korok, re } from "../index"

describe('json to xml,', function(){
  
  it('with key and array', function(){
    expect(Json2Xml.parse({articles: [0, 1, 2, 3, 4]})).to.be.equal("<articles>0</articles><articles>1</articles><articles>2</articles><articles>3</articles><articles>4</articles>")
  })

  it('with a json', function(){
    expect(Json2Xml.parse({
      article : {
          title: 'json 2 xml'
        , content: 'parse a json'
      }
    })).to.be.equal('<article title="json 2 xml" content="parse a json"></article>')
  })

  it('with array', function(){
    expect(Json2Xml.parse([0, 1, 2, 3, 4])).to.be.equal("<0></0><1>1</1><2>2</2><3>3</3><4>4</4>")
  })

  it('with nest array', function(){
    expect(Json2Xml.parse({articles: 
      [ [1, 2, 3]
      , [4, 5, 6]
      , [7, 8, 9]
      ]
    })).to.be.equal('<articles 0="1" 1="2" 2="3"></articles><articles 0="4" 1="5" 2="6"></articles><articles 0="7" 1="8" 2="9"></articles>')
  })

  // it('with nest array', function(){
  //   let str = {"loading":{"global":{"count":0},"local":{"token/":false,"question/get/":false,"question/getAnswers/19596275":false}},"entities":{"users":{},"questions":{"19596275":{"topics":[{"introduction":"Google Web Fonts 是 Google 提供的免费字体服务，开发者和设计师可以便捷地在自己的网页中使用这些 Google 提供的字体。","avatarUrl":"https://pic2.zhimg.com/8567e2e25_is.jpg","name":"Google Web Fonts","url":"http://www.zhihu.com/api/v4/topics/19575629","type":"topic","excerpt":"Google Web Fonts 是 Google 提供的免费字体服务，开发者和设计师可以便捷地在自己的网页中使用这些 Google 提供的字体。","id":"19575629"}],"excerpt":"目前并不支持中文字体，若能添加微软雅黑也好啊 ","adminClosedComment":false,"except":"目前并不支持中文字体，若能添加微软雅黑也好啊 ","isEditable":false,"id":19596275,"author":{"isFollowed":false,"avatarUrlTemplate":"https://pic2.zhimg.com/4b98fe8c1_{size}.jpg","badge":[],"type":"people","name":"五清清","url":"http://www.zhihu.com/api/v4/people/f270f4d883b23391a8aac0e9ddd13498","gender":1,"userType":"people","isAdvertiser":false,"avatarUrl":"https://pic2.zhimg.com/4b98fe8c1_is.jpg","isFollowing":false,"isOrg":false,"headline":"产品设计师","urlToken":"heisn","id":"f270f4d883b23391a8aac0e9ddd13498"},"detail":" 目前并不支持中文字体，若能添加微软雅黑也好啊 ","redirection":{"to":{},"from":[]},"commentCount":0,"allowDelete":false,"draft":{},"questionType":"normal","followerCount":5,"type":"question","suggestEdit":{"status":false,"reason":""},"status":{"isLocked":false,"isClose":false,"isEvaluate":false,"isSuggest":false},"visitCount":1060,"relationship":{"concernedFollowers":[],"isAnonymous":false,"canLock":false,"isFollowing":false,"isAuthor":false,"canCollapseAnswers":false,"canStickAnswers":false},"isMuted":false,"answerCount":1,"editableDetail":" 目前并不支持中文字体，若能添加微软雅黑也好啊 ","collapsedAnswerCount":0,"created":1302577995,"url":"http://www.zhihu.com/api/v4/questions/19596275","commentPermission":"all","title":"你是否在项目中使用了 Google font ？","updatedTime":1302579988,"isReportable":true,"canComment":{"status":true,"reason":""},"isNormal":true}},"answers":{"19625358":{"relationship":{"upvotedFollowees":[],"isAuthor":false,"isNothelp":false,"isAuthorized":false,"voting":0,"isThanked":false},"editableContent":"中文 web font现在也支持了 <a href=\"https://link.zhihu.com/?target=http%3A//www.youziku.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">youziku.com</span><span class=\"invisible\"></span><i class=\"icon-external\"></i></a> 去试试吧","markInfos":[],"excerpt":"中文 web font现在也支持了 <a href=\"https://link.zhihu.com/?target=http%3A//www.youziku.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">youziku.com</span><span class=\"invisible\"></span><i class=\"icon-external\"></i></a> 去试试吧","collapsedBy":"nobody","createdTime":1382691645,"updatedTime":1382691645,"id":19625358,"voteupCount":0,"canComment":{"status":true,"reason":""},"isCollapsed":false,"url":"http://www.zhihu.com/api/v4/answers/19625358","commentPermission":"all","author":{"isFollowed":false,"avatarUrlTemplate":"https://pic1.zhimg.com/da8e974dc_{size}.jpg","badge":[],"name":"钟日明","isAdvertiser":false,"url":"http://www.zhihu.com/api/v4/people/cbe05b737c81490c598b09de843133b7","gender":1,"userType":"people","headline":"者也","avatarUrl":"https://pic1.zhimg.com/da8e974dc_is.jpg","isFollowing":false,"isOrg":false,"type":"people","urlToken":"zhong-ri-ming-49","id":"cbe05b737c81490c598b09de843133b7"},"question":{"author":{"isFollowed":false,"avatarUrlTemplate":"https://pic2.zhimg.com/4b98fe8c1_{size}.jpg","badge":[],"name":"五清清","isAdvertiser":false,"url":"http://www.zhihu.com/api/v4/people/f270f4d883b23391a8aac0e9ddd13498","gender":1,"userType":"people","headline":"产品设计师","avatarUrl":"https://pic2.zhimg.com/4b98fe8c1_is.jpg","isFollowing":false,"isOrg":false,"type":"people","urlToken":"heisn","id":"f270f4d883b23391a8aac0e9ddd13498"},"url":"http://www.zhihu.com/api/v4/questions/19596275","created":1302577995,"updatedTime":1302579988,"questionType":"normal","title":"你是否在项目中使用了 Google font ？","type":"question","id":19596275},"suggestEdit":{"status":false,"reason":"","title":"","url":"","unnormalDetails":{},"tip":""},"content":"中文 web font现在也支持了 <a href=\"https://link.zhihu.com/?target=http%3A//www.youziku.com\" class=\" external\" target=\"_blank\" rel=\"nofollow noreferrer\"><span class=\"invisible\">http://www.</span><span class=\"visible\">youziku.com</span><span class=\"invisible\"></span><i class=\"icon-external\"></i></a> 去试试吧","commentCount":0,"extras":"","reshipmentSettings":"allowed","thanksCount":0,"isCopyable":true,"type":"answer","thumbnail":"","isNormal":true}},"articles":{},"columns":{},"topics":{},"roundtables":{},"favlists":{},"comments":{},"notifications":{},"ebooks":{},"activities":{},"feeds":{}},"currentUser":"","token":{"xUDID":""},"account":{"locakTicketStatus":false,"challenge":[],"errorStatus":false,"message":"","isFetching":false},"settings":{"experiment":{"default":"None","ge2":"ge2_1","new_more":"new","ge4":"ge4_1","explore_module":"old","ge3":"ge3_9"}},"notification":{},"pushNotifications":{"default":{"isFetching":false,"isDrained":false,"ids":[]},"follow":{"isFetching":false,"isDrained":false,"ids":[]},"vote-thank":{"isFetching":false,"isDrained":false,"ids":[]},"currentTab":"default","notificationsCount":{"default":0,"follow":0,"vote-thank":0}},"messages":{"data":{},"currentTab":"common","messageCount":0},"register":{"registerValidateSucceeded":null,"registerValidateErrors":{},"registerConfirmError":null,"sendDigitsError":null,"registerConfirmSucceeded":null},"login":{"loginConfirmError":null,"sendDigitsError":null,"loginConfirmSucceeded":null},"active":{"sendDigitsError":null,"activeConfirmSucceeded":null,"activeConfirmError":null},"people":{"isFetching":false,"activitiesByUser":{},"answersByUser":{},"answersSortByVotesByUser":{},"answersMarkedByUser":{},"votedAnswersByUser":{},"thankedAnswersByUser":{},"voteAnswersByUser":{},"thankAnswersByUser":{},"topicAnswersByUser":{},"articlesByUser":{},"articlesSortByVotesByUser":{},"pinsByUser":{},"questionsByUser":{},"commercialQuestionsByUser":{},"favlistsByUser":{},"followingByUser":{},"followersByUser":{},"mutualsByUser":{},"followingColumnsByUser":{},"followingQuestionsByUser":{},"followingFavlistsByUser":{},"followingTopicsByUser":{},"publicationsByUser":{},"columnsByUser":{},"allFavlistsByUser":{}},"question":{"followers":{},"concernedFollowers":{},"answers":{"19596275":{"isFetching":false,"isDrained":true,"ids":[19625358],"totals":1,"newIds":[19625358],"isPrevDrained":true,"previous":"http://www.zhihu.com/api/v4/questions/19596275/answers?sort_by=default&include=data%5B%2A%5D.is_normal%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Cmark_infos%2Ccreated_time%2Cupdated_time%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cupvoted_followees%3Bdata%5B%2A%5D.author.badge%5B%3F%28type%3Dbest_answerer%29%5D.topics&limit=3&offset=0","next":"http://www.zhihu.com/api/v4/questions/19596275/answers?sort_by=default&include=data%5B%2A%5D.is_normal%2Cis_sticky%2Ccollapsed_by%2Csuggest_edit%2Ccomment_count%2Ccan_comment%2Ccontent%2Ceditable_content%2Cvoteup_count%2Creshipment_settings%2Ccomment_permission%2Cmark_infos%2Ccreated_time%2Cupdated_time%2Crelationship.is_authorized%2Cis_author%2Cvoting%2Cis_thanked%2Cis_nothelp%2Cupvoted_followees%3Bdata%5B%2A%5D.author.badge%5B%3F%28type%3Dbest_answerer%29%5D.topics&limit=3&offset=3"}},"createdAnswers":{},"collapsedAnswers":{},"notificationAnswers":{},"invitationCandidates":{},"inviters":{},"invitees":{},"similarQuestions":{},"relatedLives":{},"bio":{},"brand":{}},"comments":{"pagination":{},"reverse":{},"reviewing":{},"conversation":{},"parent":{}},"shareTexts":{},"answers":{"voters":{},"copyrightApplicants":{},"favlists":{}},"banner":{},"topics":{"bios":{}},"captcha":{"captchaNeeded":false,"captchaBase64String":null,"captchaValidationMessage":null,"loginCaptchaExpires":false},"sms":{"supportedCountries":[]},"explore":{"recommendations":{}},"articles":{"voters":{}},"favlists":{"relations":{}},"pins":{"voters":{}},"topstory":{"topstorys":{"isFetching":false,"isDrained":false,"afterId":0,"items":[],"next":null},"sidebar":{"isFetching":false}},"upload":{},"video":{"data":{}},"guide":{"guide":{"isFetching":false,"isShowGuide":false}},"userAgent":{"Edge":false,"Wechat":false,"Weibo":false,"QQ":false,"Mobile":false,"Android":false,"iOS":false,"isAppleDevice":true,"Zhihu":false,"isWebView":false}}
  //   let html = Json2Xml.parse(str, {indent: true})
  //   console.log(html)
  //   let parsedBodyOpts = korok(html, {
  //     title: 'questions>*::created'
  //   })
  //   console.log(parsedBodyOpts)
  // })
})